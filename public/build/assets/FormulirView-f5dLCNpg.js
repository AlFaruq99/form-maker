var C=Object.defineProperty;var H=(s,t,r)=>t in s?C(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var x=(s,t,r)=>(H(s,typeof t!="symbol"?t+"":t,r),r);import{i as A,Z as Q,d as y,e as v,o as a,c as l,a as b,b as o,t as h,F as _,r as w,x as M,w as U,h as F,g as m,v as g,f as u,k as S,l as P}from"./app-J4YW95Gk.js";import{A as L}from"./AuthenticatedLayout-RRwp0Czz.js";import{_ as R}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./ApplicationLogo-oJ-JEFDg.js";import"./ResponsiveNavLink-ADVeyUru.js";import"./Toast-nSR5vIi3.js";class j{constructor(){x(this,"validateForm",t=>t.filter(i=>{if(i.required==1&&i.answer==null)return i}))}}class B{formatPhoneNumber(t){return t=t.replace(/\D/g,""),t.startsWith("62")&&(t=t.slice(2)),"62"+t}}const N={components:{Link:A,Head:Q,AuthenticatedLayout:L},props:{formulir:Array},data(){return{Question:Array,errorResponse:String,backgroundStyle:{background:`url(${this.formulir.image_background})`,"background-size":"cover"}}},mounted(){this.Question=this.formulir},methods:{changePhoneValueHandler(s,t){var r=s.target;const i=new B().formatPhoneNumber(r.value);this.Question.content[t].answer=i},inputFileHandler(s,t){this.Question.content[t].answer=s.target.files[0]},formValidation(s){const r=new j().validateForm(s);if(r.length>0){var s=r.map(d=>d.kolom);return s.join(","),s.join(", ")+" belum diisi"}else return!0},async postAnswerHandler(){const s=this.formValidation(this.Question.content);if(s==!0){if((await y.post(route("guest.post_formulir"),{formulir_id:this.Question.id,content:this.Question.content},{headers:{"Content-Type":"multipart/form-data"}})).status==200){successModal.showModal();let d=this.Question.content.filter(c=>c.tipe=="phone")[0].answer;var t=await this.sendResponseWaHandler(d);t&&setTimeout(()=>{window.location.href=route("guest.responsePage",{form_id:this.Question.uuid})},3e3)}}else this.errorResponse=s,errorModal.showModal()},async sendResponseWaHandler(s){try{return await y.post(route("guest.sendMessage",{form_id:this.Question.id}),{phone:s}).then(r=>!0).catch(r=>!1)}catch(t){console.log(t)}}}},T={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 gap-6"},D={class:"bg-white border card overflow-hidden p-4 grid grid-cols-1 gap-6 shadow-lg"},G=o("hr",null,null,-1),W={class:"container form-group space-y-1"},z={key:0},E=["name","onUpdate:modelValue","placeholder"],I={key:1},Z=["onInput","name","onUpdate:modelValue"],J={key:2},K=["name","required","onUpdate:modelValue"],X=["value"],Y=["required","name","onUpdate:modelValue","value","id"],O=["for"],$={key:4},ee=["required","name","onUpdate:modelValue"],te={key:5},oe=["required","name","onChange"],se={key:6,class:"text-sm italic text-red-500"},re=o("dialog",{id:"successModal",class:"modal"},[o("div",{class:"modal-box"},[o("h3",{class:"font-bold text-lg"},"Success!"),o("p",{class:"py-4"},"Berhasil menyimpan jawaban"),o("div",{class:"modal-action"},[o("form",{method:"dialog"},[o("button",{class:"btn",onClick:()=>{}},"Oke")])])])],-1),ne={id:"errorModal",class:"modal"},ae={class:"modal-box"},le=o("h3",{class:"font-bold text-lg"},"Error!",-1),ie=o("p",{class:"py-4"},"Gagal mennyimpan jawaban",-1),de=o("div",{class:"modal-action"},[o("form",{method:"dialog"},[o("button",{class:"btn"},"Close")])],-1);function ue(s,t,r,i,d,c){const k=v("Head"),V=v("Label");return a(),l(_,null,[b(k,{title:r.formulir.title},null,8,["title"]),o("div",{style:M(d.backgroundStyle),class:"py-12 min-h-screen"},[o("div",T,[o("div",D,[o("p",null,h(r.formulir.title),1),G,(a(!0),l(_,null,w(d.Question.content,(e,f)=>(a(),l("div",{class:"mt-2",key:f},[o("div",W,[b(V,null,{default:U(()=>[F(h(e.kolom),1)]),_:2},1024),e.tipe=="text"?(a(),l("div",z,[m(o("input",{type:"text",name:e.kolom,"onUpdate:modelValue":n=>e.answer=n,class:"input input-bordered w-full",placeholder:e.kolom},null,8,E),[[g,e.answer]])])):u("",!0),e.tipe=="phone"?(a(),l("div",I,[m(o("input",{type:"text",onInput:n=>c.changePhoneValueHandler(n,f),name:e.kolom,"onUpdate:modelValue":n=>e.answer=n,class:"input input-bordered w-full",placeholder:"8xx-xxxx-xxxx"},null,40,Z),[[g,e.answer]])])):u("",!0),e.tipe=="option"?(a(),l("div",J,[m(o("select",{name:e.kolom,required:e.required=="1","onUpdate:modelValue":n=>e.answer=n,class:"select select-bordered w-full",id:""},[(a(!0),l(_,null,w(e.opsi,(n,p)=>(a(),l("option",{value:n.text,key:p},h(n.text),9,X))),128))],8,K),[[S,e.answer]])])):u("",!0),e.tipe=="multiple"?(a(!0),l(_,{key:3},w(e.opsi,(n,p)=>(a(),l("div",{class:"flex flex-row items-center space-x-2",key:p},[m(o("input",{class:"checkbox",required:e.required=="1",name:e.kolom,"onUpdate:modelValue":q=>e.answer=q,"true-value":[],value:n.text,type:"checkbox",id:p},null,8,Y),[[P,e.answer]]),o("label",{for:p},h(n.text),9,O)]))),128)):u("",!0),e.tipe=="email"?(a(),l("div",$,[m(o("input",{type:"email",required:e.required=="1",name:e.kolom,"onUpdate:modelValue":n=>e.answer=n,class:"input input-bordered w-full"},null,8,ee),[[g,e.answer]])])):u("",!0),e.tipe=="file"?(a(),l("div",te,[o("input",{type:"file",required:e.required=="1",name:e.kolom,onChange:n=>c.inputFileHandler(n,f),class:"input input-bordered w-full"},null,40,oe)])):u("",!0),e.required=="1"?(a(),l("span",se,"*data harus diisi")):u("",!0)])]))),128)),o("button",{onClick:t[0]||(t[0]=(...e)=>c.postAnswerHandler&&c.postAnswerHandler(...e)),class:"btn btn-primary"},"Simpan")])])],4),re,o("dialog",ne,[o("div",ae,[le,ie,o("span",null,h(d.errorResponse),1),de])])],64)}const ge=R(N,[["render",ue]]);export{ge as default};
