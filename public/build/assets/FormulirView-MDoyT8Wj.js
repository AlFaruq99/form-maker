var C=Object.defineProperty;var H=(s,t,r)=>t in s?C(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var g=(s,t,r)=>(H(s,typeof t!="symbol"?t+"":t,r),r);import{i as A,Z as Q,d as v,e as y,o as a,c as l,a as b,b as o,t as h,F as _,r as w,w as M,h as U,g as m,v as x,f as d,k as F,m as P}from"./app-VmSF2JD4.js";import{A as L}from"./AuthenticatedLayout-p1mFd0sf.js";import{_ as R}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./ApplicationLogo-9BS91Z7e.js";import"./ResponsiveNavLink-W2eVyQKm.js";import"./Toast-e9s-PVrm.js";class S{constructor(){g(this,"validateForm",t=>t.filter(i=>{if(i.required==1&&i.answer==null)return i}))}}class j{formatPhoneNumber(t){return t=t.replace(/\D/g,""),t.startsWith("62")&&(t=t.slice(2)),"62"+t}}const B={components:{Link:A,Head:Q,AuthenticatedLayout:L},props:{formulir:Array},data(){return{Question:Array,errorResponse:String}},mounted(){this.Question=this.formulir},methods:{changePhoneValueHandler(s,t){var r=s.target;const i=new j().formatPhoneNumber(r.value);this.Question.content[t].answer=i},inputFileHandler(s,t){this.Question.content[t].answer=s.target.files[0]},formValidation(s){const r=new S().validateForm(s);if(r.length>0){var s=r.map(u=>u.kolom);return s.join(","),s.join(", ")+" belum diisi"}else return!0},async postAnswerHandler(){const s=this.formValidation(this.Question.content);if(s==!0){if((await v.post(route("guest.post_formulir"),{formulir_id:this.Question.id,content:this.Question.content},{headers:{"Content-Type":"multipart/form-data"}})).status==200){successModal.showModal();let u=this.Question.content.filter(c=>c.tipe=="phone")[0].answer;var t=await this.sendResponseWaHandler(u);t&&setTimeout(()=>{window.location.href=route("guest.responsePage",{form_id:this.Question.uuid})},3e3)}}else this.errorResponse=s,errorModal.showModal()},async sendResponseWaHandler(s){try{return await v.post(route("guest.sendMessage",{form_id:this.Question.id}),{phone:s}).then(r=>!0).catch(r=>!1)}catch(t){console.log(t)}}}},N={class:"bg-emerald-700 py-12 min-h-screen"},T={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 gap-6"},D={class:"bg-white card overflow-hidden p-4 grid grid-cols-1 gap-6 shadow-md"},G=o("hr",null,null,-1),W={class:"container form-group space-y-1"},E={key:0},I=["name","onUpdate:modelValue","placeholder"],Z={key:1},z=["onInput","name","onUpdate:modelValue"],J={key:2},K=["name","required","onUpdate:modelValue"],X=["value"],Y=["required","name","onUpdate:modelValue","value","id"],O=["for"],$={key:4},ee=["required","name","onUpdate:modelValue"],te={key:5},oe=["required","name","onChange"],se={key:6,class:"text-sm italic text-red-500"},re=o("dialog",{id:"successModal",class:"modal"},[o("div",{class:"modal-box"},[o("h3",{class:"font-bold text-lg"},"Success!"),o("p",{class:"py-4"},"Berhasil menyimpan jawaban"),o("div",{class:"modal-action"},[o("form",{method:"dialog"},[o("button",{class:"btn",onClick:()=>{}},"Oke")])])])],-1),ne={id:"errorModal",class:"modal"},ae={class:"modal-box"},le=o("h3",{class:"font-bold text-lg"},"Error!",-1),ie=o("p",{class:"py-4"},"Gagal mennyimpan jawaban",-1),de=o("div",{class:"modal-action"},[o("form",{method:"dialog"},[o("button",{class:"btn"},"Close")])],-1);function ue(s,t,r,i,u,c){const k=y("Head"),V=y("Label");return a(),l(_,null,[b(k,{title:r.formulir.title},null,8,["title"]),o("div",N,[o("div",T,[o("div",D,[o("p",null,h(r.formulir.title),1),G,(a(!0),l(_,null,w(u.Question.content,(e,f)=>(a(),l("div",{class:"mt-2",key:f},[o("div",W,[b(V,null,{default:M(()=>[U(h(e.kolom),1)]),_:2},1024),e.tipe=="text"?(a(),l("div",E,[m(o("input",{type:"text",name:e.kolom,"onUpdate:modelValue":n=>e.answer=n,class:"input input-bordered w-full",placeholder:e.kolom},null,8,I),[[x,e.answer]])])):d("",!0),e.tipe=="phone"?(a(),l("div",Z,[m(o("input",{type:"text",onInput:n=>c.changePhoneValueHandler(n,f),name:e.kolom,"onUpdate:modelValue":n=>e.answer=n,class:"input input-bordered w-full",placeholder:"8xx-xxxx-xxxx"},null,40,z),[[x,e.answer]])])):d("",!0),e.tipe=="option"?(a(),l("div",J,[m(o("select",{name:e.kolom,required:e.required=="1","onUpdate:modelValue":n=>e.answer=n,class:"select select-bordered w-full",id:""},[(a(!0),l(_,null,w(e.opsi,(n,p)=>(a(),l("option",{value:n.text,key:p},h(n.text),9,X))),128))],8,K),[[F,e.answer]])])):d("",!0),e.tipe=="multiple"?(a(!0),l(_,{key:3},w(e.opsi,(n,p)=>(a(),l("div",{class:"flex flex-row items-center space-x-2",key:p},[m(o("input",{class:"checkbox",required:e.required=="1",name:e.kolom,"onUpdate:modelValue":q=>e.answer=q,"true-value":[],value:n.text,type:"checkbox",id:p},null,8,Y),[[P,e.answer]]),o("label",{for:p},h(n.text),9,O)]))),128)):d("",!0),e.tipe=="email"?(a(),l("div",$,[m(o("input",{type:"email",required:e.required=="1",name:e.kolom,"onUpdate:modelValue":n=>e.answer=n,class:"input input-bordered w-full"},null,8,ee),[[x,e.answer]])])):d("",!0),e.tipe=="file"?(a(),l("div",te,[o("input",{type:"file",required:e.required=="1",name:e.kolom,onChange:n=>c.inputFileHandler(n,f),class:"input input-bordered w-full"},null,40,oe)])):d("",!0),e.required=="1"?(a(),l("span",se,"*data harus diisi")):d("",!0)])]))),128)),o("button",{onClick:t[0]||(t[0]=(...e)=>c.postAnswerHandler&&c.postAnswerHandler(...e)),class:"btn btn-primary"},"Simpan")])])]),re,o("dialog",ne,[o("div",ae,[le,ie,o("span",null,h(u.errorResponse),1),de])])],64)}const xe=R(B,[["render",ue]]);export{xe as default};
