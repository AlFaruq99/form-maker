var C=Object.defineProperty;var H=(s,o,r)=>o in s?C(s,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[o]=r;var x=(s,o,r)=>(H(s,typeof o!="symbol"?o+"":o,r),r);import{i as A,Z as Q,d as y,e as v,o as n,c as l,a as b,b as t,t as c,F as _,r as w,x as M,w as U,h as F,g as h,v as g,f as u,k as S,l as P}from"./app-eYzKjRAK.js";import{A as L}from"./AuthenticatedLayout-TwEkJYfA.js";import{_ as R}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./ApplicationLogo-hBQdwhqp.js";import"./ResponsiveNavLink-6myVXAOU.js";import"./Toast-1KncQ8CD.js";class j{constructor(){x(this,"validateForm",o=>o.filter(i=>{if(i.required==1&&i.answer==null)return i}))}}class B{formatPhoneNumber(o){return o=o.replace(/\D/g,""),o.startsWith("62")&&(o=o.slice(2)),"62"+o}}const T={components:{Link:A,Head:Q,AuthenticatedLayout:L},props:{formulir:Array},data(){return{Question:Array,errorResponse:String,backgroundStyle:{background:`url(${this.formulir.image_background})`,"background-size":"cover"}}},mounted(){this.Question=this.formulir},methods:{changePhoneValueHandler(s,o){var r=s.target;const i=new B().formatPhoneNumber(r.value);this.Question.content[o].answer=i},inputFileHandler(s,o){this.Question.content[o].answer=s.target.files[0]},formValidation(s){const r=new j().validateForm(s);if(r.length>0){var s=r.map(d=>d.kolom);return s.join(","),s.join(", ")+" belum diisi"}else return!0},async postAnswerHandler(){const s=this.formValidation(this.Question.content);if(s==!0){if((await y.post(route("guest.post_formulir"),{formulir_id:this.Question.id,content:this.Question.content},{headers:{"Content-Type":"multipart/form-data"}})).status==200){successModal.showModal();const i=this.Question.content.filter(d=>d.tipe=="phone");var o=!0;if(i.length>0){let d=i[0].answer;o=await this.sendResponseWaHandler(d)}o!=!1&&setTimeout(()=>{window.location.href=route("guest.responsePage",{form_id:this.Question.uuid})},3e3)}}else this.errorResponse=s,errorModal.showModal()},async sendResponseWaHandler(s){try{return await y.post(route("guest.sendMessage",{form_id:this.Question.id}),{phone:s}).then(r=>!0).catch(r=>!1)}catch{return!1}}}},D={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 gap-6"},N={class:"bg-white border card overflow-hidden p-4 grid grid-cols-1 gap-6 shadow-lg"},z=t("hr",null,null,-1),E={class:"container form-group space-y-1"},G={key:0},I=["name","onUpdate:modelValue","placeholder"],W={key:1},Z=["onInput","name","onUpdate:modelValue"],J={key:2},K=["name","required","onUpdate:modelValue"],X=["value"],Y=["required","name","onUpdate:modelValue","value","id"],O=["for"],$={key:4},ee=["required","name","onUpdate:modelValue"],te={key:5},oe=["required","name","onChange"],se={key:6,class:"text-sm italic text-red-500"},re=t("dialog",{id:"successModal",class:"modal"},[t("div",{class:"modal-box"},[t("h3",{class:"font-bold text-lg"},"Success!"),t("p",{class:"py-4"},"Berhasil menyimpan jawaban"),t("div",{class:"modal-action"},[t("form",{method:"dialog"},[t("button",{class:"btn",onClick:()=>{}},"Oke")])])])],-1),ae={id:"errorModal",class:"modal"},ne={class:"modal-box"},le=t("h3",{class:"font-bold text-lg"},"Error!",-1),ie=t("p",{class:"py-4"},"Gagal mennyimpan jawaban",-1),de=t("div",{class:"modal-action"},[t("form",{method:"dialog"},[t("button",{class:"btn"},"Close")])],-1);function ue(s,o,r,i,d,m){const k=v("Head"),V=v("Label");return n(),l(_,null,[b(k,{title:r.formulir.title},null,8,["title"]),t("div",{style:M(d.backgroundStyle),class:"py-12 min-h-screen"},[t("div",D,[t("div",N,[t("p",null,c(r.formulir.title),1),z,t("p",null,c(r.formulir.description),1),(n(!0),l(_,null,w(d.Question.content,(e,f)=>(n(),l("div",{class:"mt-2",key:f},[t("div",E,[b(V,null,{default:U(()=>[F(c(e.kolom),1)]),_:2},1024),e.tipe=="text"?(n(),l("div",G,[h(t("input",{type:"text",name:e.kolom,"onUpdate:modelValue":a=>e.answer=a,class:"input input-bordered w-full",placeholder:e.kolom},null,8,I),[[g,e.answer]])])):u("",!0),e.tipe=="phone"?(n(),l("div",W,[h(t("input",{type:"text",onInput:a=>m.changePhoneValueHandler(a,f),name:e.kolom,"onUpdate:modelValue":a=>e.answer=a,class:"input input-bordered w-full",placeholder:"8xx-xxxx-xxxx"},null,40,Z),[[g,e.answer]])])):u("",!0),e.tipe=="option"?(n(),l("div",J,[h(t("select",{name:e.kolom,required:e.required=="1","onUpdate:modelValue":a=>e.answer=a,class:"select select-bordered w-full",id:""},[(n(!0),l(_,null,w(e.opsi,(a,p)=>(n(),l("option",{value:a.text,key:p},c(a.text),9,X))),128))],8,K),[[S,e.answer]])])):u("",!0),e.tipe=="multiple"?(n(!0),l(_,{key:3},w(e.opsi,(a,p)=>(n(),l("div",{class:"flex flex-row items-center space-x-2",key:p},[h(t("input",{class:"checkbox",required:e.required=="1",name:e.kolom,"onUpdate:modelValue":q=>e.answer=q,"true-value":[],value:a.text,type:"checkbox",id:p},null,8,Y),[[P,e.answer]]),t("label",{for:p},c(a.text),9,O)]))),128)):u("",!0),e.tipe=="email"?(n(),l("div",$,[h(t("input",{type:"email",required:e.required=="1",name:e.kolom,"onUpdate:modelValue":a=>e.answer=a,class:"input input-bordered w-full"},null,8,ee),[[g,e.answer]])])):u("",!0),e.tipe=="file"?(n(),l("div",te,[t("input",{type:"file",required:e.required=="1",name:e.kolom,onChange:a=>m.inputFileHandler(a,f),class:"input input-bordered w-full"},null,40,oe)])):u("",!0),e.required=="1"?(n(),l("span",se,"*data harus diisi")):u("",!0)])]))),128)),t("button",{onClick:o[0]||(o[0]=(...e)=>m.postAnswerHandler&&m.postAnswerHandler(...e)),class:"btn btn-primary"},"Simpan")])])],4),re,t("dialog",ae,[t("div",ne,[le,ie,t("span",null,c(d.errorResponse),1),de])])],64)}const ge=R(T,[["render",ue]]);export{ge as default};
